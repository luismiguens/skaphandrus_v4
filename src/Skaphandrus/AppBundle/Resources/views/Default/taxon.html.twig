{% extends '@SkaphandrusAppBundle/Resources/views/content_layout.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/skaphandrusapp/js/jstree/dist/themes/default/style.min.css') }}" />
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/skaphandrusapp/js/jstree/dist/jstree.min.js') }}"></script>
    <script>
      $(function () {
        $("#jstree")
        .jstree({
          "core": {
            "data": {
              "url": "/{{ app.request.locale }}/species/source",
              "data": function (n) {
                return { id: n.id === '#' ? "li.{{ next_taxon }}.{{ taxon.id }}" : n.id };
              }
            }
          }
        })
        .bind("select_node.jstree", function (e, data) {
          var href = data.node.a_attr.href;
          document.location.href = href;
        });
      });
    </script>
{% endblock %}

{% block body %}
  <h2> {{ node }} : {{ taxon.name }}!</h2>

  {% if taxon.vernaculars is not empty %}
    <h3>{{ "page.taxon.h3.common_names"|trans }}</h3>
    {% for vernacular in taxon.vernaculars %}
        <p>{{ vernacular.name ~ " - " ~ intl_locale_name(vernacular.locale) }}</p>
    {% endfor %}
  {% endif %}

  <h2>{{ "page.taxon.h2.taxonomic_structure"|trans }}</h2>
  <p>{{ link_to_taxon(taxon) }}</p>
  <div id="jstree" style="text-align: left;"></div>
{% endblock %}

